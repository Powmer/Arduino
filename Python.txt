import tkinter as tk
from tkinter import messagebox, ttk
import serial
import time

#------------Funcoes----------------#
arquivo_excel = None
modo_selecionado = None

arduino = serial.Serial('COM3', 9600, timeout=1)
time.sleep(2)

def enviar_para_arduino(valor):
    arduino.write((valor + "\n").encode())
    resposta = arduino.readline().decode().strip()
    return resposta

def escolher_arquivo():
   ## usa arquivo excel como global 
    pass

def checar_atividade():
   ##Manda um sinal como um eco que caso nao ecoe de volta é considerado inativo
    global modo_selecionado
    if modo_selecionado is None:
        messagebox.showwarning("Modo","Selecione um modo")
        return
    resposta = enviar_para_arduino(modo_selecionado.get().upper())
    messagebox.showinfo("Arduino", resposta)

##Gera um grafico usando matplotlyb como o arquivo excel
def gerar_analise():
    ##except generico
    global arquivo_excel
    messagebox.showwarning("AAAAA","Função desativada no momento")

#----------------INTERFACE-----------------#
janela = tk.Tk()
janela.title("Janela Generical")
janela.geometry("500x500")

##CheckB Var
modo_açai = tk.BooleanVar()
modo_sorvete = tk.BooleanVar()
modo_bebidas = tk.BooleanVar()

#----#
check_açai = tk.Checkbutton(janela, text="Açai", variable=modo_açai)
check_sorvete = tk.Checkbutton(janela, text="Sorvete", variable=modo_sorvete)
check_bebidas = tk.Checkbutton(janela, text="Bebidas", variable=modo_bebidas)

#---#
check_açai.pack(pady=5)
check_sorvete.pack(pady=5)
check_bebidas.pack(pady=5)

##FETCH MODE
def obter_modo_selecionado():
    modos = []
    if modo_açai.get():
        modos.append("Açai")
    if modo_sorvete.get():
        modos.append("Sorvete")
    if modo_bebidas.get():
        modos.append("Bebidas")
    
    return modos

#------------------Botões---------------------------#
btn_checar = tk.Button(janela, text=" Checar atividade", width=25, command=checar_atividade)
btn_checar.pack(pady=10)

btn_analise = tk.Button(janela, text=" Gerar análise", width=25, command=gerar_analise)
btn_analise.pack(pady=10)

janela.mainloop()
