import tkinter as tk
from tkinter import messagebox, ttk
import random
import pandas as pd
import matplotlib.pyplot as plt~´;
combo["values"] = ["açai","sorvete","bebidas"]
import serial
import time

#------------Funçoes----------------#
arquivo_excel = None
modo_selecionado = None

arduino = serial.Serial('COM3', 9600, timeout=1)
time.sleep(2)

def enviar_para_arduino(valor):
    arduino.write((valor + "\n").encode())
    resposta = arduino.readline().decode().strip()
    return resposta

def escolher_arquivo():
   ## usa arquivo excel como global 
    pass

def checar_atividade():
   ##Manda um sinal como um eco que caso nao ecoe de volta é considerado inativo
    global modo_selecionado
    if modo_selecionado is None:
        messagebox.showwarning("Modo","Selecione um modo")
        return
    resposta = enviar_para_arduino(modo_selecionado.get().upper())
    messagebox.showinfo("Arduino", resposta)

##Gera um grafico usando matplotlyb como o arquivo excel
def gerar_analise():
	##except generico
    global arquivo_excel
    messagebox.showwarning("AAAAA","Função desativada no momento")

#----------------INTERFACE-----------------#
janela = tk.Tk()
janela.title("Janela Generical")
janela.geometry("500xx500")

modo_selecionado = tk.StringVar()

combo = ttk.Combobox(janela, textvariable=modo_selecionado, state="readonly")
combo["values"] = ["açai","sorvete","bebidas"]
combo.pack(pady=10)

#------------------Botões---------------------------#
btn_checar = tk.Button(janela, text=" Checar atividade", width=25, command=checar_atividade)
btn_checar.pack(pady=10)

btn_analise = tk.Button(janela, text=" Gerar análise", width=25, command=gerar_analise)
btn_analise.pack(pady=10)

janela.mainloop()
