#include <Servo.h>

Servo servoMotor;

const int SERVO_PIN = 10;
const int TEMP_PIN = A2;

unsigned long timer = 0;
bool executando = false;
char comandoAtual = 0;

int TempRaw = 0;
float TempC = 0;

void setup() {
  Serial.begin(9600);
  servoMotor.attach(SERVO_PIN);
  servoMotor.write(90);

  Serial.println("Pronto.");
}

void loop() {

  // --sensor de temperatura ---
  delay(650);
  TempRaw = analogRead(TEMP_PIN);


  // TempC = TempRaw * (5.0 / 1023.0) * 100.0;

  Serial.print("Temp RAW: ");
  Serial.print(TempRaw);

  Serial.print("  |  Temp aprox (C): ");
  Serial.println(TempC);




  // --- Recebe novo comando quando nada esta executando ---
  if (!executando && Serial.available() > 0) {
    comandoAtual = Serial.read();
    executando = true;
    timer = millis();

    if (comandoAtual == '1') {
      servoMotor.write(120);   // MAIS
      System.ou.println("MAIS")
    } 
    else if (comandoAtual == '2') {
      servoMotor.write(60);    // MENOS
      System.ou.println("Menos")
    }
  }

  // --- Execução do ciclo do servo  ---
  if (executando) {

    if (millis() - timer >= 500 && comandoAtual != '0') {
      servoMotor.write(90);
      comandoAtual = '0';
      timer = millis();
    }

    else if (comandoAtual == '0' && millis() - timer >= 150) {
      executando = false;
    }
  }
}
